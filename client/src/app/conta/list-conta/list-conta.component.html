<section class="content-header">
  <h1>
    Home
    <small>Contas</small>
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
    <li class="active">Contas</li>
  </ol>
</section>

<section class="content">
  <div class="box box-primary">
    <div class="box-header">
      <i class="ion ion-clipboard"></i>

      <h3 class="box-title">Gestão de Contas</h3>

      <div class="box-tools pull-right">
        <!-- BOTÕES DE ADICIONAR-->
        <button type="button" class="btn btn-success pull-right" [routerLink]="['/new-conta']"><i
          class="fa fa-plus"></i> Adicionar
        </button>
      </div>
    </div>
    <!-- /.box-header -->
    <app-alert-message></app-alert-message>
    <div class="box-body">
      <!-- See dist/js/pages/dashboard.js to activate the todoList plugin -->
      <table id="example1" class="table table-bordered table-striped">
        <thead>
        <tr>
          <th>Categoria</th>
          <th>Tipo</th>
          <th>Descrição</th>
          <th>Valor</th>
          <th>Competência</th>
          <th>Data de Vencimento</th>
          <th>Imóvel</th>
          <th>Atualizar</th>
          <th>Remover</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let conta of contas | paginate: { id: 'listing_pagination',
                                                      itemsPerPage: 10,
                                                      currentPage: page,
                                                      totalItems: totalRec}">
          <td>{{conta.categoria}}</td>
          <td><span class="label" [ngClass]="{'label-danger': conta.id_tipo_conta == 1, 'label-success': conta.id_tipo_conta == 2}">{{conta.tipo}}</span></td>
          <td>{{conta.descricao}}</td>
          <td>{{conta.valor | currency:"BRL":"symbol"}}</td>
          <td>{{conta.competencia | date: 'dd/MM/yyyy'}}</td>
          <td>{{conta.data_vencimento | date: 'dd/MM/yyyy'}}</td>
          <td>{{conta.imovel ? conta.imovel : 'Não se aplica'}}</td>
          <td>
            <button type="button"
                    [routerLink]="['/update-conta/'+conta.id]"
                    class="btn btn-info btn-sm">
              <i class="fa fa-edit" aria-hidden="true"></i>
            </button>
          </td>
          <td>
            <button type="button"
                    (click)="openModalConfirmRemove(template, conta.id)"
                    class="btn btn-danger btn-sm">
              <i class="fa fa-trash" aria-hidden="true"></i>
            </button>
          </td>
        </tr>
        <tr class="animate-repeat" *ngIf="contas.length == 0">
          <td colspan="8" class="text-center">
            <em>
              Nenhum resultado foi encontrado
            </em>
          </td>
        </tr>
        </tbody>
      </table>
      <div>
        <pagination-controls id="listing_pagination" maxSize="5" directionLinks="true"
                             (pageChange)="page = $event"></pagination-controls>
      </div>
    </div>
    <!-- /.box-body -->

  </div>
</section>

<ng-template #template>
  <div class="alert-box">
    <div class="modal-header">
      <h4 class="modal-title pull-left">Confirmação de exclusão</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      Confirma a exclusão deste registro?
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="confirmRemove()">Sim</button>
      <button type="button" class="btn btn-default" (click)="decline()">Não</button>
    </div>
  </div>
</ng-template>

<ngx-loading [show]="loading"></ngx-loading>

